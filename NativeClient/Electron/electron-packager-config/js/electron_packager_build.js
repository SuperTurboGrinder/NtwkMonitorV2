!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t){e.exports=require("electron-packager")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),o=i(2);let r=null;n({dir:"app",executableName:"NetworkMonitorV2",name:"NetMonitorV2",asar:!0,afterExtract:[(e,t,i,n,s)=>{(r=new o.BuildPipeline(i,n)).buildAllUnbuiltSubprojects().then(t=>{t&&r.copyWebAPITo(e).then(e=>s())})}],afterPrune:[(e,t,i,n,o)=>{r.copyWebUITo(e).then(()=>o())}]}).then(e=>{console.log(`Electron app was packaged to ${e}`)})},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(s,u)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(3),r=i(4),s=i(5);t.BuildPipeline=class{constructor(e,t){this.componentsBuildPath=__dirname+"../../../../",this.webAPIAppDir="NativeClient.WebAPI",this.webUIAppDir="NativeClient.WebUI",this.dotnetRuntimeID=null,this.dotnetRuntimeID=this._packagerPlatformAndArchToDotnetRuntimeID(e,t)}_packagerPlatformAndArchToDotnetRuntimeID(e,t){const i=new Map([["win32","win"],["linux","linux"],["darvin","osx"]]).get(e),n=new Map([["ia32","x86"],["x64","x64"]]).get(t);if(void 0===n||void 0===i||"x86"===n&&"win"!==i)throw new Error(`Wrong platform (${e}) or arch (${t}).`);return i+"-"+n}runConsoleCommand(e,t,i){const n=r.spawn(t,i,{cwd:e});return n.stdout.pipe(process.stdout),n.stderr.pipe(process.stderr),new Promise((e,t)=>{n.on("close",t=>e(t))})}isPathOK(e){return s.pathExists(o.normalize(e))}isElectronAppBuilt(){return n(this,void 0,void 0,function*(){const e=__dirname+"../../../app/js/";return(yield this.isPathOK(e+"main.js"))&&(yield this.isPathOK(e+"renderer.js"))})}isUIAppBuilt(){return n(this,void 0,void 0,function*(){const e=this.componentsBuildPath+this.webUIAppDir+"dist";return yield this.isPathOK(e+"WebUI")})}isAPIAppBuilt(){return n(this,void 0,void 0,function*(){const e=this.componentsBuildPath+this.webAPIAppDir+"/bin/release/netcoreapp2.2/";return yield this.isPathOK(e+this.dotnetRuntimeID+"/publish")})}buildElectronApp(){return console.log("Building ElectronApp"),this.runConsoleCommand(__dirname+"../../../","npm",["run","build"])}buildWebAPI(){return n(this,void 0,void 0,function*(){console.log("Building WebAPI");const e=this.componentsBuildPath+this.webAPIAppDir;return this.runConsoleCommand(e,"dotnet",["publish","-c","release","-r",this.dotnetRuntimeID])})}buildWebUI(){console.log("Building WebUI");const e=this.componentsBuildPath+this.webUIAppDir;return this.runConsoleCommand(e,"ng",["build","--prod","--aot"])}rebuildAllSubprojects(){return n(this,void 0,void 0,function*(){return 0===(yield this.buildElectronApp())&&0===(yield this.buildWebAPI())&&0===(yield this.buildWebUI())})}buildAllUnbuiltSubprojects(){return n(this,void 0,void 0,function*(){return!1!==((yield this.isElectronAppBuilt())&&0===(yield this.buildElectronApp()))&&!1!==((yield this.isUIAppBuilt())&&0===(yield this.buildWebUI()))&&(yield this.isAPIAppBuilt())&&0===(yield this.buildWebAPI())})}copyWebUITo(e){return n(this,void 0,void 0,function*(){console.log("Copying WebUI dir to electron package..."),yield s.copy(o.normalize(this.componentsBuildPath+this.webUIAppDir+"dist/WebUI"),o.normalize(e+"/WebUI")),console.log("Finished copying WebUI dir.")})}copyWebAPITo(e){return n(this,void 0,void 0,function*(){console.log("Copying WebAPI dir to electron package...");const t=this.componentsBuildPath+this.webAPIAppDir+"/bin/release/netcoreapp2.2/"+this.dotnetRuntimeID+"/publish";yield s.copy(o.normalize(t),o.normalize(e+"/WebAPI")),console.log("Finished copying WebAPI dir.")})}}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("fs-extra")}]);